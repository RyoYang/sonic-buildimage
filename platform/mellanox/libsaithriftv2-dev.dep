# DPKG FRK

SPATH := $($(LIBSAITHRIFTV2_DEV)_SRC_PATH)
SLINKS := $(shell find $(SPATH) -type l -exec echo {} \; | grep -Ev ' ')
SMDEP_PATHS := $(SPATH) $(addprefix $(SPATH)/,$(shell cd $(SPATH) && git submodule status --recursive | awk '{print $$2}' | grep -Ev ' '))
SMDEP_FILES := $(foreach path,$(SMDEP_PATHS),$(filter-out $(SMDEP_PATHS),$(addprefix $(path)/,$(shell cd $(path) && git ls-files | grep -Ev ' '))))
DEP_FILES := $(SONIC_COMMON_FILES_LIST) $(PLATFORM_PATH)/libsaithriftv2-dev.mk $(PLATFORM_PATH)/libsaithriftv2-dev.dep
DEP_FILES += $(SONIC_COMMON_BASE_FILES_LIST)

$(LIBSAITHRIFTV2_DEV)_CACHE_MODE := GIT_CONTENT_SHA
$(LIBSAITHRIFTV2_DEV)_DEP_FLAGS := $(SONIC_COMMON_FLAGS_LIST)
$(LIBSAITHRIFTV2_DEV)_DEP_FILES := $(DEP_FILES)
$(LIBSAITHRIFTV2_DEV)_SMDEP_FILES := $(filter-out $(SLINKS),$(SMDEP_FILES))
$(LIBSAITHRIFTV2_DEV)_SMDEP_PATHS := $(SMDEP_PATHS)

$(PYTHON3_SAITHRIFT)_CACHE_MODE := GIT_CONTENT_SHA
$(PYTHON3_SAITHRIFT)_DEP_FLAGS := $(SONIC_COMMON_FLAGS_LIST)
$(PYTHON3_SAITHRIFT)_DEP_FILES := $(DEP_FILES)
$(PYTHON3_SAITHRIFT)_SMDEP_FILES := $(filter-out $(SLINKS),$(SMDEP_FILES))
$(PYTHON3_SAITHRIFT)_SMDEP_PATHS := $(SMDEP_PATHS)

$(SAISERVERV2)_CACHE_MODE := GIT_CONTENT_SHA
$(SAISERVERV2)_DEP_FLAGS := $(SONIC_COMMON_FLAGS_LIST)
$(SAISERVERV2)_DEP_FILES := $(DEP_FILES)
$(SAISERVERV2)_SMDEP_FILES := $(filter-out $(SLINKS),$(SMDEP_FILES))
$(SAISERVERV2)_SMDEP_PATHS := $(SMDEP_PATHS)

$(SAISERVERV2_DBG)_CACHE_MODE := GIT_CONTENT_SHA
$(SAISERVERV2_DBG)_DEP_FLAGS := $(SONIC_COMMON_FLAGS_LIST)
$(SAISERVERV2_DBG)_DEP_FILES := $(DEP_FILES)
$(SAISERVERV2_DBG)_SMDEP_FILES := $(filter-out $(SLINKS),$(SMDEP_FILES))
$(SAISERVERV2_DBG)_SMDEP_PATHS := $(SMDEP_PATHS)
